<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ keyval.value.type === 'list' ? keyval.value.name : keyval.key }}</ion-title>
    <ion-buttons *ngIf="keyval.value.type === 'object' && keyval.value.nullable" slot="end">
      <ion-button color="danger" (click)="presentAlertDestroy()">
        Delete
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-item-group *ngIf="keyval.value.changeWarning">
    <ion-item>
      <ion-label class="ion-text-wrap">
        <h3><ion-text color="danger">Warning!</ion-text></h3>
        <br />
        <h2><ion-text color="medium">{{ keyval.value.changeWarning }}</ion-text></h2>
      </ion-label>
    </ion-item>
  </ion-item-group>

  <div *ngIf="keyval.value.type === 'list'">

    <div *ngIf="keyval.value.spec.type !== 'enum'">

      <ion-item-group>
        <ion-item-divider>
          {{ value.length }}&nbsp;
          <span *ngIf="value.length === 1">Entry</span>
          <span *ngIf="value.length !== 1">Entries</span>
          <span *ngIf="min">&nbsp;(min: {{ min }})</span>
          <span *ngIf="max">&nbsp;(max: {{ max }})</span>
        </ion-item-divider>

        <div *ngFor="let entry of value; let i = index">
          <ion-item-sliding *ngIf="['string', 'number'].includes(keyval.value.spec.type)">
            <ion-item-options side="end">
              <ion-item-option color="danger" (click)="deleteEntry(i)">
                <ion-icon slot="icon-only" name="trash"></ion-icon>
              </ion-item-option>
            </ion-item-options>
            <ion-item button detail="false" (click)="presentModalValueEdit(i)">
              <ion-label>{{ entry }}<span *ngIf="keyval.value.spec.type === 'number'"> {{ keyval.value.spec.units }}</span></ion-label>
            </ion-item>
          </ion-item-sliding>
          <ion-item-sliding *ngIf="keyval.value.spec.type === 'object'">
            <ion-item-options side="end">
              <ion-item-option color="danger" (click)="deleteEntry(i)">Delete</ion-item-option>
            </ion-item-options>
            <ion-item button detail="false" (click)="presentModalConfig(i, keyval.value.spec)">
              <ion-label>{{ keyval.key }} {{ i + 1 }}</ion-label>
              <ion-icon slot="end" name="arrow-forward"></ion-icon>
            </ion-item>
          </ion-item-sliding>
        </div>
      </ion-item-group>

      <ion-fab vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button (click)="addEntry()" class="fab-button">
          <ion-icon name="add"></ion-icon>
        </ion-fab-button>
      </ion-fab>
    </div>

    <ion-item-group *ngIf="keyval.value.spec.type === 'enum'">
      <ion-item-divider>
        {{ value.length }} selected
        <span *ngIf="min">&nbsp;(min: {{ min }})</span>
        <span *ngIf="max">&nbsp;(max: {{ max }})</span>
      </ion-item-divider>
      <ion-item *ngFor="let option of keyval.value.spec.values">
        <ion-label>{{ option }}</ion-label>
        <ion-checkbox slot="end" [checked]="value.includes(option)" (ionChange)="handleEnumChange(option)"></ion-checkbox>
      </ion-item>
    </ion-item-group>
  </div>

  <ion-item-group *ngIf="keyval.value.type === 'object'">
    <ion-item-divider></ion-item-divider>
    <object-config [spec]="keyval.value.spec" [(edited)]="edited" [config]="value"></object-config>
  </ion-item-group>

</ion-content>
